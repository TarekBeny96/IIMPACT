{% comment %}
  sections/pay-icons-grid.liquid
  Payment icons grid (Impact compatible)
  - Auto icons from enabled payment types
  - Optional extra icons via blocks
{% endcomment %}

{% liquid
  assign sid = section.id
  assign auto_icons = shop.enabled_payment_types
%}

<section class="paygrid paygrid--{{ sid }} color-{{ section.settings.color_scheme }}">
  <div class="paygrid__wrap">
    {% if section.settings.title != blank %}
      <h2 class="paygrid__title">{{ section.settings.title }}</h2>
    {% endif %}

    <div class="paygrid__grid" aria-label="Payment methods">
      {%- if section.settings.show_auto_icons -%}
        {%- for type in auto_icons -%}
          <div class="paygrid__item" title="{{ type | replace: '_', ' ' | upcase }}">
            {{ type | payment_type_svg_tag: class: 'paygrid__svg' }}
          </div>
        {%- endfor -%}
      {%- endif -%}

      {%- for block in section.blocks -%}
        {%- if block.type == 'icon' and block.settings.image != blank -%}
          <div class="paygrid__item" {{ block.shopify_attributes }}>
            {{
              block.settings.image
              | image_url: width: 160
              | image_tag:
                loading: 'lazy',
                decoding: 'async',
                class: 'paygrid__img',
                alt: block.settings.label | escape
            }}
          </div>
        {%- endif -%}
      {%- endfor -%}
    </div>
  </div>
</section>

<style>
  .paygrid--{{ sid }}{
    --pg-max: {{ section.settings.max_width }}px;
    --pg-gap-m: {{ section.settings.gap_mobile }}px;
    --pg-gap-d: {{ section.settings.gap_desktop }}px;
    --pg-cols-m: {{ section.settings.cols_mobile }};
    --pg-cols-d: {{ section.settings.cols_desktop }};
    --pg-radius: {{ section.settings.card_radius }}px;
    --pg-pad: {{ section.settings.card_padding }}px;
    --pg-icon: {{ section.settings.icon_size }}px;
    --pg-border: {{ section.settings.border_opacity | divided_by: 100.0 }};
  }

  .paygrid--{{ sid }} .paygrid__wrap{
    max-width: var(--pg-max);
    margin: 0 auto;
    padding: {{ section.settings.padding_top_mobile }}px 15px {{ section.settings.padding_bottom_mobile }}px;
    text-align: center;
  }

  @media (min-width: 990px){
    .paygrid--{{ sid }} .paygrid__wrap{
      padding: {{ section.settings.padding_top_desktop }}px 15px {{ section.settings.padding_bottom_desktop }}px;
    }
  }

  .paygrid--{{ sid }} .paygrid__title{
    margin: 0 0 18px;
    font-weight: 500;
    letter-spacing: 0.02em;
    font-size: {{ section.settings.title_size_mobile }}px;
    color: rgb(var(--color-foreground));
  }

  @media (min-width: 990px){
    .paygrid--{{ sid }} .paygrid__title{
      font-size: {{ section.settings.title_size_desktop }}px;
      margin-bottom: 22px;
    }
  }

  .paygrid--{{ sid }} .paygrid__grid{
    display: grid;
    grid-template-columns: repeat(var(--pg-cols-m), minmax(0, 1fr));
    gap: var(--pg-gap-m);
    align-items: center;
    justify-items: center;
  }

  @media (min-width: 990px){
    .paygrid--{{ sid }} .paygrid__grid{
      grid-template-columns: repeat(var(--pg-cols-d), minmax(0, 1fr));
      gap: var(--pg-gap-d);
    }
  }

  .paygrid--{{ sid }} .paygrid__item{
    width: 100%;
    max-width: 120px;
    background: #fff;
    border-radius: var(--pg-radius);
    padding: var(--pg-pad);
    border: 1px solid rgba(0,0,0,var(--pg-border));
    box-shadow: 0 10px 22px rgba(0,0,0,0.05);
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: calc(var(--pg-icon) + var(--pg-pad) * 2);
  }

  .paygrid--{{ sid }} .paygrid__svg{
    width: var(--pg-icon);
    height: auto;
    display: block;
  }

  .paygrid--{{ sid }} .paygrid__img{
    width: var(--pg-icon);
    height: auto;
    display: block;
  }
</style>

{% schema %}
{
  "name": "Pay icons grid",
  "settings": [
    { "type": "text", "id": "title", "label": "Title", "default": "Safe payment on our website" },

    { "type": "checkbox", "id": "show_auto_icons", "label": "Show Shopify payment icons automatically", "default": true },

    { "type": "header", "content": "Layout" },
    { "type": "range", "id": "max_width", "label": "Max width (px)", "min": 600, "max": 1600, "step": 20, "default": 1200 },

    { "type": "range", "id": "cols_mobile", "label": "Columns mobile", "min": 2, "max": 5, "step": 1, "default": 3 },
    { "type": "range", "id": "cols_desktop", "label": "Columns desktop", "min": 4, "max": 8, "step": 1, "default": 5 },

    { "type": "range", "id": "gap_mobile", "label": "Gap mobile (px)", "min": 6, "max": 24, "step": 1, "default": 12 },
    { "type": "range", "id": "gap_desktop", "label": "Gap desktop (px)", "min": 8, "max": 30, "step": 1, "default": 18 },

    { "type": "header", "content": "Cards" },
    { "type": "range", "id": "card_radius", "label": "Card radius (px)", "min": 0, "max": 24, "step": 1, "default": 8 },
    { "type": "range", "id": "card_padding", "label": "Card padding (px)", "min": 6, "max": 22, "step": 1, "default": 10 },
    { "type": "range", "id": "border_opacity", "label": "Border opacity (%)", "min": 0, "max": 20, "step": 1, "default": 8 },

    { "type": "header", "content": "Icons" },
    { "type": "range", "id": "icon_size", "label": "Icon size (px)", "min": 36, "max": 90, "step": 1, "default": 62 },

    { "type": "header", "content": "Text" },
    { "type": "range", "id": "title_size_mobile", "label": "Title size mobile (px)", "min": 14, "max": 32, "step": 1, "default": 22 },
    { "type": "range", "id": "title_size_desktop", "label": "Title size desktop (px)", "min": 16, "max": 42, "step": 1, "default": 28 },

    { "type": "header", "content": "Spacing" },
    { "type": "range", "id": "padding_top_mobile", "label": "Padding top mobile (px)", "min": 0, "max": 120, "step": 4, "default": 16 },
    { "type": "range", "id": "padding_bottom_mobile", "label": "Padding bottom mobile (px)", "min": 0, "max": 120, "step": 4, "default": 16 },
    { "type": "range", "id": "padding_top_desktop", "label": "Padding top desktop (px)", "min": 0, "max": 160, "step": 4, "default": 24 },
    { "type": "range", "id": "padding_bottom_desktop", "label": "Padding bottom desktop (px)", "min": 0, "max": 160, "step": 4, "default": 24 },

    { "type": "header", "content": "Colors" },
    { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme", "default": "background-1" }
  ],
  "blocks": [
    {
      "type": "icon",
      "name": "Extra icon",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Icon image" },
        { "type": "text", "id": "label", "label": "Alt text", "default": "Payment method" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Pay icons grid",
      "blocks": []
    }
  ]
}
{% endschema %}
